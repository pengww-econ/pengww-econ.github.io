<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>深圳大数据研究院 · 招聘 & 问卷</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <style>
    body{padding-top:40px;}
    .required::after{content:" *";color:#d00;}
    fieldset{border:1px solid #ced4da;padding:1.5rem;border-radius:.5rem;margin-bottom:1.5rem;}
    legend{width:auto;padding:0 .5rem;font-weight:600;}
    .scale-hint{font-size:.9rem;color:#6c757d;}
    .is-valid{border-color:#198754!important;}
  </style>
</head>
<body>
<div class="container">

  <!-- Header -->
  <header class="mb-4 text-center">
    <img src="logo.png" alt="深圳大数据研究院" style="height:80px"/>
    <h1 class="h3 mt-3">深圳大数据研究院 · 招聘 & 问卷</h1>
  </header>

  <!-- ============ Main Form ============ -->
  <form id="applyForm" method="post" action="/api/apply" enctype="application/x-www-form-urlencoded">

    <!-- 1. 基本信息 -->
    <fieldset>
      <legend>一、基本信息</legend>
      <div class="row g-3">
        <div class="col-md-6"><label class="form-label required">姓名</label><input name="name" class="form-control" required></div>
        <div class="col-md-6"><label class="form-label required">性别</label>
          <select name="gender" class="form-select" required><option value="">请选择</option><option>男</option><option>女</option><option>其他</option></select></div>
        <div class="col-md-6"><label class="form-label required">出生年份</label><select name="birth_year" class="form-select" required></select></div>
        <div class="col-md-6"><label class="form-label required">手机号</label><input name="phone" class="form-control" pattern="[0-9]{11}" required></div>
        <div class="col-md-6"><label class="form-label required">邮箱</label><input type="email" name="email" class="form-control" required></div>
        <div class="col-md-6"><label class="form-label required">当前城市</label><input name="city" class="form-control" required></div>
        <div class="col-md-6"><label class="form-label required">最高学历</label>
          <select name="education" class="form-select" required><option value="">请选择</option><option>硕士</option><option>博士</option><option>博士后</option></select></div>
        <div class="col-md-6"><label class="form-label required">毕业院校</label><input name="university" class="form-control" required></div>
        <div class="col-md-6"><label class="form-label required">所学专业</label><input name="major" class="form-control" required></div>
        <div class="col-md-6"><label class="form-label required">当前状态</label>
          <select name="status" class="form-select" required><option>在读</option><option>求职中</option><option>在职</option></select></div>
      </div>
    </fieldset>

    <!-- 2. 上传材料 -->
    <fieldset>
      <legend>二、上传材料</legend>
      <div class="mb-3">
        <label class="form-label required">个人简历（PDF ≤10 MB）</label>
        <input class="form-control" type="file" id="cv" accept="application/pdf" required>
        <input type="hidden" name="cv_url">
      </div>
      <div class="mb-3">
        <label class="form-label">硕士论文（PDF ≤30 MB）</label>
        <input class="form-control" type="file" id="master_thesis" accept="application/pdf">
        <input type="hidden" name="master_thesis_url">
      </div>
      <div class="mb-3">
        <label class="form-label">博士论文（PDF ≤50 MB）</label>
        <input class="form-control" type="file" id="phd_thesis" accept="application/pdf">
        <input type="hidden" name="phd_thesis_url">
      </div>
      <div class="form-text">⚠️ 选择文件后将自动上传，成功后输入框会变绿。</div>
    </fieldset>

      <button class="btn btn-primary btn-lg w-100" type="submit">提交</button>

   <!-- 问卷说明 -->
    <div class="alert alert-secondary">
      <strong>问卷说明：</strong> 本问卷匿名，仅用于科研统计；全部为<strong>可选</strong>题。预计用时 8–10 分钟。
    </div>

    <!-- 问卷 -->
    <fieldset>
      <legend>问卷（选答）</legend>

    <!-- (一) 印象管理 -->
    <h6 class="mt-3">(一) 印象管理 — Likert 1–5</h6>
    <div class="mb-2">1. 我从未故意说过会伤害他人感情的话。(反向)<br>
      1<input type="radio" name="q1" value="1"> 2<input type="radio" name="q1" value="2"> 3<input type="radio" name="q1" value="3"> 4<input type="radio" name="q1" value="4"> 5<input type="radio" name="q1" value="5">
    </div>
    <div class="mb-2">2. 即使无人监督，我也始终遵守每一条规定。(反向)<br>
      1<input type="radio" name="q2" value="1"> 2<input type="radio" name="q2" value="2"> 3<input type="radio" name="q2" value="3"> 4<input type="radio" name="q2" value="4"> 5<input type="radio" name="q2" value="5">
    </div>
    <div class="mb-2">3. 在某些场合，我会把公共物品（如公司文具）带回自用。(反向)<br>
      1<input type="radio" name="q3" value="1"> 2<input type="radio" name="q3" value="2"> 3<input type="radio" name="q3" value="3"> 4<input type="radio" name="q3" value="4"> 5<input type="radio" name="q3" value="5">
    </div>
    <div class="mb-2">4. 面对他人冒犯，我有时会在心里生闷气。(反向)<br>
      1<input type="radio" name="q4" value="1"> 2<input type="radio" name="q4" value="2"> 3<input type="radio" name="q4" value="3"> 4<input type="radio" name="q4" value="4"> 5<input type="radio" name="q4" value="5">
    </div>
    <div class="mb-3">5. 回顾过去，我也会反思自己是否始终足够诚实。(反向)<br>
      1<input type="radio" name="q5" value="1"> 2<input type="radio" name="q5" value="2"> 3<input type="radio" name="q5" value="3"> 4<input type="radio" name="q5" value="4"> 5<input type="radio" name="q5" value="5">
    </div>

    <!-- (二) 尽责性 / 自我控制 -->
    <h6 class="mt-3">(二) 尽责性 / 自我控制 — FREQ 1–5</h6>
    <div class="mb-2">6. 我通常会在截止日期 24 小时以上前完成文件或报告。<br>
      1<input type="radio" name="q6" value="1"> 2<input type="radio" name="q6" value="2"> 3<input type="radio" name="q6" value="3"> 4<input type="radio" name="q6" value="4"> 5<input type="radio" name="q6" value="5">
    </div>
    <div class="mb-2">7. 偶尔会因事务繁忙而错过截止日期或会议提醒。(反向)<br>
      1<input type="radio" name="q7" value="1"> 2<input type="radio" name="q7" value="2"> 3<input type="radio" name="q7" value="3"> 4<input type="radio" name="q7" value="4"> 5<input type="radio" name="q7" value="5">
    </div>
    <div class="mb-2">8. 即使工作枯燥，我也坚持做到彻底完成。<br>
      1<input type="radio" name="q8" value="1"> 2<input type="radio" name="q8" value="2"> 3<input type="radio" name="q8" value="3"> 4<input type="radio" name="q8" value="4"> 5<input type="radio" name="q8" value="5">
    </div>
    <div class="mb-2">9. 在工作时段，我会抽空查看消息或社交媒体。(反向)<br>
      1<input type="radio" name="q9" value="1"> 2<input type="radio" name="q9" value="2"> 3<input type="radio" name="q9" value="3"> 4<input type="radio" name="q9" value="4"> 5<input type="radio" name="q9" value="5">
    </div>
    <div class="mb-2">10. 我会事先规划当天工作并基本照计划执行。<br>
      1<input type="radio" name="q10" value="1"> 2<input type="radio" name="q10" value="2"> 3<input type="radio" name="q10" value="3"> 4<input type="radio" name="q10" value="4"> 5<input type="radio" name="q10" value="5">
    </div>
    <div class="mb-2">11. 开始任务前，我并不总是先核对全部资料是否齐备。(反向)<br>
      1<input type="radio" name="q11" value="1"> 2<input type="radio" name="q11" value="2"> 3<input type="radio" name="q11" value="3"> 4<input type="radio" name="q11" value="4"> 5<input type="radio" name="q11" value="5">
    </div>
    <div class="mb-2">12. 当有更紧急/新颖的项目出现时，我会优先处理新项目。(反向)<br>
      1<input type="radio" name="q12" value="1"> 2<input type="radio" name="q12" value="2"> 3<input type="radio" name="q12" value="3"> 4<input type="radio" name="q12" value="4"> 5<input type="radio" name="q12" value="5">
    </div>
    <div class="mb-3">13. 当零食、手机等诱惑可能干扰工作时，我能抵制它们。<br>
      1<input type="radio" name="q13" value="1"> 2<input type="radio" name="q13" value="2"> 3<input type="radio" name="q13" value="3"> 4<input type="radio" name="q13" value="4"> 5<input type="radio" name="q13" value="5">
    </div>

    <!-- (三) 诚实/谦逊 A/B -->
    <!-- ……已按之前建议替换 15-B 与 17-B，其他保持 …… -->

    <!-- (四) SJT -->
    <!-- ……文字已替换为更柔和版本 …… -->

    <!-- (五) 外在成就动机 ~ (十一) RRT -->
    <!-- 其余题干与前版一致，若有需要可继续参照上表自行替换 -->

    </fieldset>

   <!-- 隐私 & 提交 -->
<!--     <div class="form-check mb-3">
      <input class="form-check-input" type="checkbox" id="agree" required>
      <label class="form-check-label" for="agree">我已阅读并同意 <a href="/privacy" target="_blank">隐私政策</a></label>
    </div> -->
    <button class="btn btn-primary btn-lg w-100" type="submit">提交</button>

  </form>

  <!-- Footer -->
  <footer class="mt-5 text-center small text-muted">
    <p>© 2025 深圳大数据研究院</p>
    <p><a href="mailto:research@szbigdata.org.cn">research@szbigdata.org.cn</a></p>
  </footer>
  </form>

  <!-- Footer -->
  <!-- ……与之前相同 …… -->
</div>
<!-- ================== JS ================== -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
  /************ 1. 出生年份下拉 ************/
  (() => {
    const sel=document.querySelector('[name="birth_year"]'), now=new Date().getFullYear();
    for(let y=now-70;y<=now;y++) sel.append(new Option(y,y));
  })();

  /************ 2. 直传 Aliyun OSS ************/
  const API_BASE="";          // 若前端与后端不同源，请写完整域名，如 https://recruit.example.com
  async function getPolicy(filename,field){
    const url=`https://pengww-econ.github.io/api/oss_policy?filename=${encodeURIComponent(filename)}&field=${field}`;
    const res=await fetch(url);
    if(!res.ok) throw new Error(`无法获取上传凭证 (${res.status})`);
    return res.json();
  }
  async function uploadToOSS(file,field){
    try{
      const p=await getPolicy(file.name,field);
      const fd=new FormData();
      Object.entries({key:p.key,policy:p.policy,
        OSSAccessKeyId:p.accessid,signature:p.signature,
        success_action_status:'201'}).forEach(([k,v])=>fd.append(k,v));
      fd.append('file',file);
      const r=await fetch(p.host,{method:'POST',body:fd});
      if(r.status===201){
        document.querySelector(`[name="${field}_url"]`).value=p.url;
        const inp=document.getElementById(field);
        inp.dataset.uploaded='1';inp.classList.add('is-valid');
      }else throw new Error('上传失败');
    }catch(err){alert('文件上传失败：'+err.message);}
  }
  ['cv','master_thesis','phd_thesis'].forEach(id=>{
    const el=document.getElementById(id);
    el&&el.addEventListener('change',e=>{
      const f=e.target.files[0]; if(f) uploadToOSS(f,id);
    });
  });

  /************ 3. 表单提交校验 ************/
  document.getElementById('applyForm').addEventListener('submit',e=>{
    const cv=document.getElementById('cv');
    if(cv.required && !cv.dataset.uploaded){
      e.preventDefault();alert('请等待简历上传完成再提交'); }
  });
</script>
</body>
</html>
